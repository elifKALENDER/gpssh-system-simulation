C  FILE CARWASH.FOR                       REVISED 5/20/92

$ NOTSTRICT
$ STORAGE:2
$ NOTLARGE
$ NOFLOATCALLS


      SUBROUTINE INTLC

      PARAMETER (MEQT=100,  MSCND=25, MENTR=50,  MRSC=75, MARR=50, 
     1  MGAT=25, MHIST=50, MCELS=500, MCLCT=50, MSTAT=50,MEQV=100,
     2  MATRB=100, MFILS=100, MPLOT=10,  MVARP=10,  MSTRM=10,         
     3  MACT=100, MNODE=500, MITYP=50, MMXXV=100, MNSET = 16000,
     4  MMXFLD=50)
      PARAMETER ( MAXLVL=50,MXMACS=20,MXBRKS=10)
      PARAMETER (MVARP1=MVARP+1)

      COMMON/SCOM1/ ATRIB(MATRB), DD(MEQT), DDL(MEQT), DTNOW, II, MFA,
     1MSTOP, NCLNR, NCRDR, NPRNT, NNRUN, NNSET, NTAPE, SS(MEQT),
     2SSL(MEQT), TNEXT, TNOW, XX(MMXXV)

      OPEN(20,FILE='CARWASH.ATF',STATUS='UNKNOWN')   !ESTABLISH ATF FILE

      RETURN
      END



      SUBROUTINE EVENT(I)

      PARAMETER (MEQT=100,  MSCND=25, MENTR=50,  MRSC=75, MARR=50, 
     1  MGAT=25, MHIST=50, MCELS=500, MCLCT=50, MSTAT=50,MEQV=100,
     2  MATRB=100, MFILS=100, MPLOT=10,  MVARP=10,  MSTRM=10,         
     3  MACT=100, MNODE=500, MITYP=50, MMXXV=100, MNSET = 16000,
     4  MMXFLD=50)
      PARAMETER ( MAXLVL=50,MXMACS=20,MXBRKS=10)
      PARAMETER (MVARP1=MVARP+1)

      COMMON/SCOM1/ ATRIB(MATRB), DD(MEQT), DDL(MEQT), DTNOW, II, MFA,
     1MSTOP, NCLNR, NCRDR, NPRNT, NNRUN, NNSET, NTAPE, SS(MEQT),
     2SSL(MEQT), TNEXT, TNOW, XX(MMXXV)

      WRITE(20,10)TNOW          ! RECORD TIME OF CURRENT EVENT
10    FORMAT('TIME',F7.2)
      GOTO(1,2,3,4),I

1     CONTINUE                  ! UPON CAR ARRIVAL
         II = II + 1            ! PROVIDE AN OBJECT NUMBER
         ATRIB(1) = II          ! OBJECT NUMBER IS AN ATTRIBUTE
         WRITE(20,11)II         ! WRITE OBJECT TYPE & OBJECT NUMBER
         WRITE(20,12)II         ! PLACE ON ENTRY PATH
11       FORMAT('CREATE Car',I3,)
12       FORMAT('PLACE',I3,' ON ENTRY')
      RETURN

2     CONTINUE                      ! UPON STARTING ON CHAIN DRIVE
         WRITE(20,21)IFIX(ATRIB(1)) ! PLACE CAR ON CHAIN PATH
21       FORMAT('PLACE',I3,' ON CHAIN')
      RETURN

3     CONTINUE                       ! UPON STARTIN ON EXIT PATH
         WRITE(20,31)IFIX(ATRIB(1))  ! PLACE CAR ON EXIT PATH
31       FORMAT('PLACE',I3,' ON EXIT')
      RETURN

4     CONTINUE                       ! AT END OF EXIT PATH
         WRITE(20,41)IFIX(ATRIB(1))  ! DESTROY CAR OBJECT
41       FORMAT('DESTROY',I3)
      RETURN

      END



      SUBROUTINE OTPUT
      WRITE(20,1)             ! LABEL END OF ATF FILE
1     FORMAT('END')
      CLOSE(20)               ! CLOSE CARWASH.ATF FILE
      RETURN
      END


